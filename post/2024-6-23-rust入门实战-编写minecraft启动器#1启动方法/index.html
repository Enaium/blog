<!doctype html><html><head><meta charset=UTF-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>Rust入门实战 编写Minecraft启动器#1启动方法</title>
<link rel=stylesheet href=/css/bootstrap.min.css><link rel=stylesheet href=/css/styles.css></head><body class="d-flex flex-column justify-content-between min-vh-100"><nav class="navbar navbar-expand-lg bg-light"><div class=container-fluid><a class=navbar-brand href=/><img src=/assets/github.svg alt=Logo width=30 height=24 class="d-inline-block align-text-top">
Enaium的博客
</a><button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarNav aria-controls=navbarNav aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarNav><ul class=navbar-nav><li class=nav-item><a class=nav-link aria-current=page href=https://blog.enaium.cn/contact/>联系</a></li><li class=nav-item><a class=nav-link aria-current=page href=https://blog.enaium.cn/about/>关于</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" data-bs-toggle=dropdown href=# role=button aria-expanded=false><img alt=Logo width=30 height=24 src=/assets/language.svg></a><ul class=dropdown-menu></ul></li></ul></div></div></nav><div style=flex:1><div class=container><div class=card><div class=card-header>Rust入门实战 编写Minecraft启动器#1启动方法</div><div class=card-body><div class=card-text><h2 id=引言>引言</h2><p>想必大家都知道<code>Minecraft</code>这个游戏，它是一个非常有趣的游戏，有没有想过它是如何启动的呢？在本系列中，我们将使用<code>Rust</code>编写一个简单的<code>Minecraft</code>启动器。</p><p>本系列文章涉及的<code>Rust</code>知识并不多，了解<code>Rust</code>的基本语法即可，如果你对<code>Minecraft</code>或者<code>Java</code>有一定了解，那么会更容易理解本系列的内容。</p><h2 id=观前须知>观前须知</h2><p>本系列文章只考虑如何完成一个简单的<code>Minecraft</code>启动器，不考虑支持启动老的游戏版本，也不考虑第三方的客户端，更不会去考虑正版验证等等，只是一个简单的启动器。</p><h2 id=启动方法>启动方法</h2><p>首先<code>Minecarft</code>是使用<code>Java</code>编写的，所以我们需要通过执行<code>Java</code>命令来启动<code>Minecraft</code>，并且也需要添加一些参数，比如游戏的一些资源文件，<code>Java</code>的一些参数等等。</p><p>大概就像这样：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>java -Xmx10745m -cp <span style=color:#e6db74>&#34;minecraft.jar;lib/*&#34;</span> -Djava.library.path<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;natives&#34;</span> net.minecraft.client.main.Main --username yourname --version 1.21
</span></span></code></pre></div><h3 id=下载资源>下载资源</h3><p>第一步我们需要下载<code>Minecraft</code>的资源文件，包括游戏本体、依赖库、资源文件。</p><p><code>http://launchermeta.mojang.com/mc/game/version_manifest.json</code>这个地址可以读取到游戏所有版本。</p><p><code>https://piston-meta.mojang.com/v1/packages/&lt;sha1>/&lt;version>.json</code>这个地址可以获取到游戏的配置信息。</p><p><code>http://resources.download.minecraft.net/&lt;sha1_first_two>/&lt;sha1></code>这个地址可以获取到游戏的资源文件。</p><p><code>https://libraries.minecraft.net/&lt;group>/&lt;artifact>/&lt;version>/&lt;artifact>-&lt;version>.jar</code>这个地址可以获取到游戏的依赖库。</p><h3 id=游戏目录结构>游戏目录结构</h3><p>首先游戏的所有资源都在一个目录中，这个目录包括<code>libraries</code>、<code>assets</code>、<code>versions</code>等文件夹，这个目录通常是<code>.minecraft</code>。</p><p><code>libraries</code>文件夹存放游戏的依赖库，目录结构和<code>Maven</code>的目录结构类似。</p><p><code>assets</code>文件夹存放游戏的资源文件，其中包括<code>objects</code>和<code>indexes</code>，<code>objects</code>存放资源文件，所有的资源文件都是以<code>sha1</code>命名的，所以<code>objects</code>文件夹下有一个以2位<code>sha1</code>命名的文件夹，所有前两位<code>sha1</code>相同的资源文件都在这个文件夹下，<code>indexes</code>存放资源文件的索引文件，也就是包含了资源文件的真实名称和对应的<code>sha1</code>值。</p><p><code>versions</code>文件夹存放游戏的版本文件，每个版本都有一个以版本号命名的文件夹，这个文件夹包括<code>natives</code>，它存放游戏的本地库文件，我们需要在游戏启动的时候将所有<code>native</code>的<code>jar</code>文件都解压到这个文件夹下，这个文件夹还包括<code>&lt;version>.json</code>，这个文件包括了游戏的配置信息，比如<code>mainClass</code>，<code>assets</code>等等，还有<code>&lt;version>.jar</code>，这个文件是游戏的本体文件。</p><h3 id=拼接命令>拼接命令</h3><p>完成以上步骤后，我们就可以拼接命令了，首先是<code>java</code>的程序路径，然后是<code>JVM</code>参数，然后是<code>classpath</code>，接着是<code>main</code>方法的类路径，最后是<code>Minecraft</code>的参数。</p><p>拼接完成之后就可以执行这个命令启动游戏了。</p><h2 id=项目结构>项目结构</h2><p>本项目分为 4 个模块：<code>download</code>, <code>launch</code>, <code>model</code>, <code>parse</code>。</p><ul><li><p><code>download</code>模块用于下载游戏资源文件。</p></li><li><p><code>launch</code>模块用于启动游戏。</p></li><li><p><code>model</code>模块用建立游戏的数据模型。</p></li><li><p><code>parse</code>模块用于解析游戏的配置文件。</p></li></ul><h2 id=流程>流程</h2><pre tabindex=0><code class=language-mermaid data-lang=mermaid>graph LR
    建立资源模型 --&gt; 解析资源配置 --&gt; 下载游戏资源 --&gt; 拼接启动命令 --&gt; 启动游戏
</code></pre><h2 id=结语>结语</h2><p>好了，本文就到这里了，之后的一些内容会在后续文章中介绍。</p></div><div class="d-flex justify-content-between"><a class=text-reset href=https://blog.enaium.cn/post/2024-6-8-%E4%BD%BF%E7%94%A8kotlin%E7%BC%96%E5%86%99%E4%B8%80%E4%B8%AAhttp%E6%9C%8D%E5%8A%A1%E5%99%A8/>使用Kotlin编写一个Http服务器</a>
<a class=text-reset href=https://blog.enaium.cn/post/2024-6-30-rust%E5%85%A5%E9%97%A8%E5%AE%9E%E6%88%98-%E7%BC%96%E5%86%99minecraft%E5%90%AF%E5%8A%A8%E5%99%A8%232%E5%BB%BA%E7%AB%8B%E8%B5%84%E6%BA%90%E6%A8%A1%E5%9E%8B/>Rust入门实战 编写Minecraft启动器#2建立资源模型</a></div></div></div></div></div><footer class="p-5 bg-dark text-white text-center"><div class=container><p class=lead>Copyright &copy; 2024 Enaium</p></div></footer><script src=/js/bootstrap.bundle.min.js></script></body></html>