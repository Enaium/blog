<!doctype html><html><head><meta charset=UTF-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>Windows下Rust OpenCV环境配置</title>
<link rel=stylesheet href=/css/bootstrap.min.css><link rel=stylesheet href=/css/styles.css></head><body class="d-flex flex-column justify-content-between min-vh-100"><nav class="navbar navbar-expand-lg bg-light"><div class=container-fluid><a class=navbar-brand href=/><img src=/assets/github.svg alt=Logo width=30 height=24 class="d-inline-block align-text-top">
Enaium的博客
</a><button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarNav aria-controls=navbarNav aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarNav><ul class=navbar-nav><li class=nav-item><a class=nav-link aria-current=page href=https://blog.enaium.cn/contact/>联系</a></li><li class=nav-item><a class=nav-link aria-current=page href=https://blog.enaium.cn/about/>关于</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" data-bs-toggle=dropdown href=# role=button aria-expanded=false><img alt=Logo width=30 height=24 src=/assets/language.svg></a><ul class=dropdown-menu></ul></li></ul></div></div></nav><div style=flex:1><div class=container><div class=card><div class=card-header>Windows下Rust OpenCV环境配置</div><div class=card-body><div class=card-text><h2 id=安装chocolatey>安装Chocolatey</h2><p>首先我们需要<a href=https://chocolatey.org/>安装<code>Chocolatey</code></a>，<code>Chocolatey</code>是一个Windows的包管理器。</p><p>我们点击右上角的<code>Install</code>进入到<code>Installing Chocolatey</code>，选择<code>Individual</code></p><p>复制命令</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>Set-ExecutionPolicy Bypass -Scope <span style=color:#66d9ef>Process</span> -Force; [<span style=color:#66d9ef>System.Net.ServicePointManager</span>]::SecurityProtocol = [<span style=color:#66d9ef>System.Net.ServicePointManager</span>]::SecurityProtocol <span style=color:#f92672>-bor</span> <span style=color:#ae81ff>3072</span>; iex ((New-Object System.Net.WebClient).DownloadString(<span style=color:#e6db74>&#39;https://community.chocolatey.org/install.ps1&#39;</span>))
</span></span></code></pre></div><p>使用管理员模式打开<code>PowerShell</code>，粘贴命令，等待安装完成。</p><h2 id=安装llvm和opencv>安装llvm和opencv</h2><p>安装过程中可能会由于网络问题导致安装失败，可以多次尝试。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>choco install llvm opencv
</span></span></code></pre></div><h2 id=配置环境变量>配置环境变量</h2><p>首先设置<code>OPENCV_INCLUDE_PATHS</code>环境变量，值为<code>C:\tools\opencv\build\include</code>，然后设置<code>OPENCV_LINK_PATHS</code>环境变量，值为<code>C:\tools\opencv\build\x64\vc16\lib</code>，接着设置<code>OPENCV_LINK_LIBS</code>环境变量，值为<code>opencv_worldxxxx</code>，<code>xxxx</code>是你的<code>OpenCV</code>版本号，例如<code>opencv_world4100</code>。</p><p>最后我们需要将<code>C:\tools\opencv\build\x64\vc16\bin</code>添加到<code>Path</code>环境变量中。</p><h2 id=配置cargotoml>配置Cargo.toml</h2><p>在<code>Cargo.toml</code>中添加如下内容：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-toml data-lang=toml><span style=display:flex><span>[<span style=color:#a6e22e>dependencies</span>]
</span></span><span style=display:flex><span><span style=color:#a6e22e>opencv</span> = <span style=color:#e6db74>&#34;0.92.1&#34;</span>
</span></span></code></pre></div><h2 id=测试>测试</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rs data-lang=rs><span style=display:flex><span><span style=color:#66d9ef>use</span> opencv::{Error, highgui, imgcodecs};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>main</span>() -&gt; Result<span style=color:#f92672>&lt;</span>(), Error<span style=color:#f92672>&gt;</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> image_path <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;images/mugshot.png&#34;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> image <span style=color:#f92672>=</span> imgcodecs::imread(<span style=color:#f92672>&amp;</span>image_path, imgcodecs::<span style=color:#66d9ef>IMREAD_COLOR</span>)<span style=color:#f92672>?</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    highgui::imshow(<span style=color:#e6db74>&#34;trump.png&#34;</span>, <span style=color:#f92672>&amp;</span>image)<span style=color:#f92672>?</span>;
</span></span><span style=display:flex><span>    highgui::wait_key(<span style=color:#ae81ff>0</span>)<span style=color:#f92672>?</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> Ok(());
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>运行<code>cargo run</code>，如果一切正常，你将看到一张图片弹出。</p><p><img src=https://s21.ax1x.com/2024/07/28/pkqHbVg.png alt=trump.png></p></div><div class="d-flex justify-content-between"><a class=text-reset href=https://blog.enaium.cn/post/2024-7-13-vue%E9%A1%B9%E7%9B%AE%E6%95%B4%E5%90%88cordova%E4%B8%80%E9%94%AE%E6%89%93%E5%8C%85apk/>Vue项目整合Cordova一键打包apk</a>
<a class=text-reset href=https://blog.enaium.cn/post/2024-8-3-%E6%98%9F%E9%9C%B2%E8%B0%B7%E6%A8%A1%E7%BB%84%E5%BC%80%E5%8F%91%E6%95%99%E7%A8%8B%231-%E9%85%8D%E7%BD%AE%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/>星露谷模组开发教程#1 配置开发环境</a></div></div></div></div></div><footer class="p-5 bg-dark text-white text-center"><div class=container><p class=lead>Copyright &copy; 2024 Enaium</p></div></footer><script src=/js/bootstrap.bundle.min.js></script></body></html>